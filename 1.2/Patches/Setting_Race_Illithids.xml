<?xml version="1.0" encoding="utf-8" ?>
<Patch>

	<Operation Class="O21Settings_ForgottenRealms.PatchOperation_SettingActive">
		<settings>
			<li>factionToggle_illithid</li>
		</settings>
		<inactive Class="PatchOperationSequence">
			<success>Always</success>
			<operations>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/FactionDef[defName="O21_IllithidTribes"]</xpath>
				</li>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/PawnKindDef[defName="O21_IllithidTribes_Peasant"]</xpath>
				</li>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/PawnKindDef[defName="O21_IllithidTribes_Merchant"]</xpath>
				</li>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/PawnKindDef[defName="O21_IllithidTribes_Fighter"]</xpath>
				</li>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/PawnKindDef[defName="O21_IllithidTribes_Warrior"]</xpath>
				</li>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/PawnKindDef[defName="O21_IllithidTribes_Bowman"]</xpath>
				</li>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/PawnKindDef[defName="O21_IllithidTribes_Champion"]</xpath>
				</li>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/PawnKindDef[defName="O21_IllithidTribes_Chief"]</xpath>
				</li>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/PawnKindDef[@Name="O21_IllithidTribePawnBase"]</xpath>
				</li>
			</operations>
		</inactive>
	</Operation>

	<Operation Class="O21Settings_ForgottenRealms.PatchOperation_SettingActive">
		<settings>
			<li>raceToggle_illithid</li>
		</settings>
		<inactive Class="PatchOperationSequence">
			<success>Always</success>
			<operations>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/AlienRace.RaceSettings[defName="O21_Illithid_Settings"]</xpath>
				</li>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/ScenarioDef[defName="O21_MedivalIllithids"]</xpath>
				</li>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/HediffDef[defName="O21_Hediff_IllithidCeremorphosis"]</xpath>
				</li>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/ThingDef[defName="O21_Item_IllithidTadpole"]</xpath>
				</li>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/ThingDef[defName="O21_Item_ElderBrain"]</xpath>
				</li>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/ThingDef[defName="O21_Building_ElderBrainPool"]</xpath>
				</li>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/FactionDef[defName="O21_IllithidPlayerColony"]</xpath>
				</li>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/FactionDef[defName="O21_IllithidPlayerTribe"]</xpath>
				</li>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/PawnKindDef[defName="O21_Illithid"]</xpath>
				</li>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/PawnKindDef[defName="O21_IllithidTribal"]</xpath>
				</li>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/PawnKindDef[defName="O21_IllithidConverted"]</xpath>
				</li>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/AlienRace.ThingDef_AlienRace[defName="O21_Alien_Illithid"]</xpath>
				</li>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/ThingDef[defName="O21_Leather_Illithid"]</xpath>
				</li>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/RecipeDef[defName="O21_ImplantIllithidTadpole"]</xpath>
				</li>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/BodyDef[defName="O21_Body_Illithid"]</xpath>
				</li>
			</operations>
		</inactive>
		<active Class="PatchOperationSequence">
			<success>Always</success>
			<operations>
				<li Class="PatchOperationFindMod">
					<mods>
						<li>Royalty</li>
					</mods>
					<match Class="PatchOperationSequence">
						<success>Always</success>
						<operations>
							<li Class="PatchOperationAdd">
								<xpath>/Defs/FactionDef[defName="Empire"]/permanentEnemyToEveryoneExcept</xpath>
								<value>
									<li>O21_IllithidPlayerColony</li>
									<li>O21_IllithidPlayerTribe</li>
								</value>
							</li>
							<li Class="PatchOperationAdd">
								<xpath>/Defs/ThingDef[defName="O21_Alien_Illithid"]/statBases</xpath>
								<value>
									<PsychicEntropyMax>80</PsychicEntropyMax>
									<PsychicEntropyRecoveryRate>12</PsychicEntropyRecoveryRate>
									<PsychicEntropyGain>0.3</PsychicEntropyGain>
								</value>
							</li>
						</operations>
					</match>
				</li>
				<li Class="PatchOperationAdd">
					<!-- Human Surgery -->
					<xpath>/Defs/ThingDef[defName="Human"]/recipes</xpath>
					<value>
						<li>O21_ImplantIllithidTadpole</li>
					</value>
				</li>
				<li Class="O21Settings_ForgottenRealms.PatchOperation_SettingActive">
					<settings>
						<li>settingToggle_raceIntegration</li>
					</settings>
					<active Class="PatchOperationSequence">
						<success>Always</success>
						<operations>
							<li Class="PatchOperationAdd">
								<xpath>/Defs/PawnKindDef[@Name="PirateBase"]/modExtensions/li[@Class="O21Toolbox.PawnKindExt.DefModExt_ExtendedPawnKind"]/altRaces</xpath>
								<value>
									<li>
										<races>
											<li>O21_Alien_Illithid</li>
										</races>
										<weight>2</weight>
									</li>
								</value>
							</li>
							<li Class="PatchOperationAdd">
								<xpath>/Defs/PawnKindDef[@Name="OutlanderBase"]/modExtensions/li[@Class="O21Toolbox.PawnKindExt.DefModExt_ExtendedPawnKind"]/altRaces</xpath>
								<value>
									<li>
										<races>
											<li>O21_Alien_Illithid</li>
										</races>
										<weight>2</weight>
									</li>
								</value>
							</li>
							<li Class="PatchOperationAdd">
								<xpath>/Defs/PawnKindDef[@Name="MercenaryBase"]/modExtensions/li[@Class="O21Toolbox.PawnKindExt.DefModExt_ExtendedPawnKind"]/altRaces</xpath>
								<value>
									<li>
										<races>
											<li>O21_Alien_Illithid</li>
										</races>
										<weight>2</weight>
									</li>
								</value>
							</li>
							<li Class="PatchOperationAdd">
								<xpath>/Defs/PawnKindDef[@Name="TribalBase"]/modExtensions/li[@Class="O21Toolbox.PawnKindExt.DefModExt_ExtendedPawnKind"]/altRaces</xpath>
								<value>
									<li>
										<races>
											<li>O21_Alien_Illithid</li>
										</races>
										<weight>2</weight>
									</li>
								</value>
							</li>
							<li Class="PatchOperationAdd">
								<xpath>/Defs/AlienRace.RaceSettings[defName="O21_FR_SpeciesIntegration"]/startingColonists</xpath>
								<value>
									<li>
										<pawnKindEntries>
											<li>
												<kindDefs>
													<li>O21_Illithid</li>
												</kindDefs>
												<chance>1.0</chance>
											</li>
										</pawnKindEntries>
										<factionDefs>
											<li>PlayerColony</li>
										</factionDefs>
									</li>
									<li>
										<pawnKindEntries>
											<li>
												<kindDefs>
													<li>O21_IllithidTribal</li>
												</kindDefs>
												<chance>1.0</chance>
											</li>
										</pawnKindEntries>
										<factionDefs>
											<li>PlayerTribe</li>
										</factionDefs>
									</li>
								</value>
							</li>
							<li Class="PatchOperationAdd">
								<xpath>/Defs/AlienRace.RaceSettings[defName="O21_FR_SpeciesIntegration"]/alienwandererkinds</xpath>
								<value>
									<li>
										<pawnKindEntries>
											<li>
												<kindDefs>
													<li>O21_Illithid</li>
												</kindDefs>
												<chance>1.0</chance>
											</li>
										</pawnKindEntries>
										<factionDefs>
											<li>PlayerColony</li>
										</factionDefs>
									</li>
									<li>
										<pawnKindEntries>
											<li>
												<kindDefs>
													<li>O21_IllithidTribal</li>
												</kindDefs>
												<chance>1.0</chance>
											</li>
										</pawnKindEntries>
										<factionDefs>
											<li>PlayerTribe</li>
										</factionDefs>
									</li>
								</value>
							</li>
						</operations>
					</active>
				</li>
			</operations>
		</active>
	</Operation>

</Patch>